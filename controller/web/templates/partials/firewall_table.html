{% for rule in rules %}
<tr id="firewall-{{ rule.id }}">
    <td class="px-6 py-4 whitespace-nowrap">
        {% if rule.enabled %}
        <button hx-post="/firewall/{{ rule.id }}/toggle"
                hx-target="#firewall-table"
                hx-swap="innerHTML"
                class="relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent bg-green-500 transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2"
                title="Click to disable">
            <span class="translate-x-5 inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out"></span>
        </button>
        {% else %}
        <button hx-post="/firewall/{{ rule.id }}/toggle"
                hx-target="#firewall-table"
                hx-swap="innerHTML"
                class="relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent bg-gray-200 transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"
                title="Click to enable">
            <span class="translate-x-0 inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out"></span>
        </button>
        {% endif %}
    </td>
    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-blue-600">
        {{ rule.port }}
    </td>
    <td class="px-6 py-4 whitespace-nowrap">
        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full
            {% if rule.protocol.value == 'tcp' %}bg-blue-100 text-blue-800{% else %}bg-purple-100 text-purple-800{% endif %}">
            {{ rule.protocol.value.upper() }}
        </span>
    </td>
    <td class="px-6 py-4 whitespace-nowrap">
        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full
            {% if rule.interface == 'public' %}bg-red-100 text-red-800
            {% elif rule.interface == 'wireguard' %}bg-green-100 text-green-800
            {% else %}bg-gray-100 text-gray-800{% endif %}">
            {{ rule.interface }}
        </span>
    </td>
    <td class="px-6 py-4 whitespace-nowrap">
        {% if rule.action.value == 'block' %}
        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800">
            BLOCK
        </span>
        {% else %}
        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
            ALLOW
        </span>
        {% endif %}
    </td>
    <td class="px-6 py-4 whitespace-nowrap text-sm">
        {% if rule.agent_id %}
        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800">
            {{ rule.agent.hostname if rule.agent else 'Agent #' ~ rule.agent_id }}
        </span>
        {% else %}
        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-gray-100 text-gray-800">
            All Agents
        </span>
        {% endif %}
    </td>
    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
        {{ rule.description or '-' }}
    </td>
    <td class="px-6 py-4 whitespace-nowrap text-sm">
        <button hx-delete="/firewall/{{ rule.id }}"
                hx-target="#firewall-{{ rule.id }}"
                hx-swap="outerHTML"
                hx-confirm="Are you sure you want to delete this firewall rule?"
                class="text-red-600 hover:text-red-900">
            Delete
        </button>
    </td>
</tr>
{% else %}
<tr>
    <td colspan="8" class="px-6 py-4 text-center text-sm text-gray-500">
        No firewall rules defined. Add a rule above or use one of the quick presets.
    </td>
</tr>
{% endfor %}
