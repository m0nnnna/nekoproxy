{% for rule in rules %}
<tr id="firewall-{{ rule.id }}">
    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">{{ rule.id }}</td>
    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-blue-600">
        {{ rule.port }}
    </td>
    <td class="px-6 py-4 whitespace-nowrap">
        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full
            {% if rule.protocol.value == 'tcp' %}bg-blue-100 text-blue-800{% else %}bg-purple-100 text-purple-800{% endif %}">
            {{ rule.protocol.value.upper() }}
        </span>
    </td>
    <td class="px-6 py-4 whitespace-nowrap">
        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full
            {% if rule.interface == 'public' %}bg-red-100 text-red-800
            {% elif rule.interface == 'wireguard' %}bg-green-100 text-green-800
            {% else %}bg-gray-100 text-gray-800{% endif %}">
            {{ rule.interface }}
        </span>
    </td>
    <td class="px-6 py-4 whitespace-nowrap">
        {% if rule.action.value == 'block' %}
        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800">
            BLOCK
        </span>
        {% else %}
        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
            ALLOW
        </span>
        {% endif %}
    </td>
    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
        {{ rule.description or '-' }}
    </td>
    <td class="px-6 py-4 whitespace-nowrap">
        {% if rule.enabled %}
        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
            Enabled
        </span>
        {% else %}
        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-gray-100 text-gray-800">
            Disabled
        </span>
        {% endif %}
    </td>
    <td class="px-6 py-4 whitespace-nowrap text-sm space-x-2">
        <button hx-post="/firewall/{{ rule.id }}/toggle"
                hx-target="#firewall-table"
                hx-swap="innerHTML"
                class="{% if rule.enabled %}text-yellow-600 hover:text-yellow-900{% else %}text-green-600 hover:text-green-900{% endif %}">
            {% if rule.enabled %}Disable{% else %}Enable{% endif %}
        </button>
        <button hx-delete="/firewall/{{ rule.id }}"
                hx-target="#firewall-{{ rule.id }}"
                hx-swap="outerHTML"
                hx-confirm="Are you sure you want to delete this firewall rule?"
                class="text-red-600 hover:text-red-900">
            Delete
        </button>
    </td>
</tr>
{% else %}
<tr>
    <td colspan="8" class="px-6 py-4 text-center text-sm text-gray-500">
        No firewall rules defined. Add a rule above or use one of the quick presets.
    </td>
</tr>
{% endfor %}
