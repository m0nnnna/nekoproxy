{% for assignment in assignments %}
<tr id="assignment-{{ assignment.id }}">
    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">{{ assignment.id }}</td>
    <td class="px-6 py-4 whitespace-nowrap">
        <div class="text-sm font-medium text-gray-900">{{ assignment.service.name }}</div>
        <div class="text-xs text-gray-500">:{{ assignment.service.listen_port }} -> {{ assignment.service.backend_host }}:{{ assignment.service.backend_port }}</div>
    </td>
    <td class="px-6 py-4 whitespace-nowrap">
        {% if assignment.agent %}
        <div class="text-sm text-gray-900">{{ assignment.agent.hostname }}</div>
        <div class="text-xs text-gray-500">{{ assignment.agent.wireguard_ip }}</div>
        {% else %}
        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-purple-100 text-purple-800">
            All Agents
        </span>
        {% endif %}
    </td>
    <td class="px-6 py-4 whitespace-nowrap">
        {% if assignment.enabled %}
        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
            Enabled
        </span>
        {% else %}
        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-gray-100 text-gray-800">
            Disabled
        </span>
        {% endif %}
    </td>
    <td class="px-6 py-4 whitespace-nowrap text-sm space-x-2">
        <button hx-post="/assignments/{{ assignment.id }}/toggle"
                hx-target="#assignments-table"
                hx-swap="innerHTML"
                class="{% if assignment.enabled %}text-yellow-600 hover:text-yellow-900{% else %}text-green-600 hover:text-green-900{% endif %}">
            {% if assignment.enabled %}Disable{% else %}Enable{% endif %}
        </button>
        <button hx-delete="/assignments/{{ assignment.id }}"
                hx-target="#assignment-{{ assignment.id }}"
                hx-swap="outerHTML"
                hx-confirm="Are you sure you want to remove this assignment?"
                class="text-red-600 hover:text-red-900">
            Delete
        </button>
    </td>
</tr>
{% else %}
<tr>
    <td colspan="5" class="px-6 py-4 text-center text-sm text-gray-500">
        No service assignments. Assign a service to agents above.
    </td>
</tr>
{% endfor %}
